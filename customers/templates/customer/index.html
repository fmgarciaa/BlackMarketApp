{% extends 'base.html' %}
{% block content %}
  <!--Create Button-->
  <div align="left" class="btn_crear mb-1 ml-1 mr-1">
    <a href="create" type="button" class="btn btn-primary btn-lg btn-block">Create New Customer</a>
  </div>
<!---->
<!--Search buuttom-->
<form class="m-2">
  <input class="form-control mr-sm-2" type="search" placeholder="Search" id="myInput">
</form>
<!---->
<!---->
<div style="overflow-x:auto;">
  <table class="table ml-1 table-bordered" id="myTable">
    <thead class= "thead-dark" style="display:table-header-group">
      <tr>
        <th>Full Name</th>
        <th>Direction</th>
        <th>District</th>
        <th>Reference</th>
        <th>Phone</th>
        <th>Frequent</th>
        <th>Register date</th>
        <th>Acctions</th>
      </tr>
    </thead>
    <tbody>
    
    <!-- Recorremos los objetos o registros que tenemos en nuestra tabla 'customers' y los listamos -->
    {% for customer in object_list %}
      <tr>
        <td>{{ customer.full_name }}</td>
        <td>{{ customer.direction }}</td>
        <td>{{ customer.get_district_display }}</td>
        <td>{{ customer.reference }}</td>
        <td>{{ customer.phone_number }}</td>
        <td>{{ customer.is_regular_client }}</td>
        <td>{{ customer.register_date }}</td>

        <td>                    
            {% csrf_token %}
            <div class="btn-group">

              <a href="edit/{{customer.id}}" title="Editar" type="button" class="btn btn-primary">Editar </a>
              
              <button class="btn btn-danger" onclick="return deletecustomer({{customer.id}});" type="submit">
                Eliminar
              </button>
              <form action="delete/{{customer.id}}" method="POST" id="myForm">{% csrf_token %}</form>

            </div>
        </td>
      </tr>
    {% endfor %}
   
    </tbody>
  </table>
</div>
<script>
  $("#myInput").on("keyup", function() {
    var value = $(this).val().toLowerCase();
    $("#myTable tbody tr").filter(function() {
        $(this).toggle($(this).find("td:first").text().toLowerCase().indexOf(value) > -1)
      });
    });
</script>
<script type="text/javascript">
  function deletecustomer(id) {
    Swal.fire({
      "title": "Are you sure?",
      "text": "This action can not be undone",
      "icon": "question",
      "showCancelButton": true,
      "cancelButtonText": "No, cancel",
      "confirmButtonText": "Yes, delete",
      "confirmButtonColor": "#dc3545"
    }).then(resultado => {
      if (resultado.value) {
        document.querySelector('#myForm').submit();
      }else{
        window.location.href="./";
      }
    })
  }
</script>

{% endblock  %}

